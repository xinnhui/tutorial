(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{8342:function(e,t,a){"use strict";var i=a("eecd"),n=a.n(i);n.a},a55b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-wrapper"},[a("Modal",{staticClass:"login-alert-modal",attrs:{width:"400","footer-hide":!0}},[a("div",{staticClass:"modal-header",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("登录")])]),a("div",{staticClass:"login-alert-msg"},[e._v("\n      登录后，临时账号的流量与积分将转移至邮箱账号，是否确认登录？\n    ")]),a("Button",{attrs:{size:"large",type:"primary"},on:{click:e.login}},[e._v("登录")])],1),a("div",{staticClass:"login-form"},[a("div",{staticClass:"modal-header",attrs:{slot:"header"},slot:"header"},[a("span",{directives:[{name:"t",rawName:"v-t",value:e.modalTitle,expression:"modalTitle"}]})]),a("div",{staticClass:"form-line"},[a("label",{directives:[{name:"t",rawName:"v-t",value:"account.ui.email",expression:"'account.ui.email'"}],attrs:{for:"login-email"}}),a("Input",{ref:"login-email-input",staticClass:"email-input",attrs:{id:"login-email",placeholder:"请输入邮箱"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.loginEmail,callback:function(t){e.loginEmail=t},expression:"loginEmail"}})],1),a("div",{staticClass:"form-line"},[a("label",{directives:[{name:"t",rawName:"v-t",value:"account.ui.password",expression:"'account.ui.password'"}],attrs:{for:"login-password"}}),a("Input",{staticClass:"password-input",attrs:{type:"password",id:"login-password",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.loginPassword,callback:function(t){e.loginPassword=t},expression:"loginPassword"}}),a("p",{staticClass:"forget-pwd-hint"},[a("span",{staticClass:"account-jump-btn reset-pwd-btn",on:{click:e.resetpwd}},[e._v("\n          忘记密码\n        ")])])],1),e.loginNeedCaptcha?a("div",{staticClass:"form-line"},[a("label",{directives:[{name:"t",rawName:"v-t",value:"account.ui.captcha",expression:"'account.ui.captcha'"}],attrs:{for:"login-captcha"}}),a("Input",{staticClass:"login-input",attrs:{id:"login-captcha",placeholder:"请输入验证码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.loginCaptcha,callback:function(t){e.loginCaptcha=t},expression:"loginCaptcha"}}),a("img",{staticClass:"captcha-image login-captcha-image",attrs:{src:e.loginCaptchaSrc,alt:"",title:"switch"},on:{click:e.refreshCaptcha}})],1):e._e(),a("Button",{directives:[{name:"t",rawName:"v-t",value:"account.ui.login",expression:"'account.ui.login'"}],staticClass:"login-btn large",attrs:{loading:e.loggingIn,disabled:0===e.loginEmail.length||0===e.loginPassword.length||0===e.loginCaptcha.length,type:"primary",size:"large"},on:{click:e.login}}),a("p",{staticClass:"footer"},[e._v("\n      没有账号？\n      "),a("span",{staticClass:"account-jump-btn reg-btn",on:{click:e.register}},[e._v("注册")])])],1)],1)},n=[],s=a("d225"),o=a("b0b4"),l=a("308d"),c=a("6bb5"),r=a("4e2b"),g=a("9ab4"),u=a("60a3"),d=a("1ffa"),p=a("b011"),h=a("0d32"),m=a("d8c6"),v=a("d565"),f=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.loginEmail="",e.loginPassword="",e.loginNeedCaptcha=!0,e.loginCaptchaSrc="",e.loginCaptcha="",e.loggingIn=!1,e.modalTitle="account.ui.login",e.tempToken="",e}return Object(r["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){var e=this;console.log("login mounted"),window.sendIpcMessage(m["b"]),this.refreshCaptcha(),window.addIpcListener(m["h"],(function(t){v["a"].$emit("plt",t.plt),e.tempToken=t.tempToken})),this.initPage()}},{key:"register",value:function(){this.$router.push("/register")}},{key:"created",value:function(){}},{key:"resetpwd",value:function(){this.$router.push("/resetpwd")}},{key:"initPage",value:function(){var e=this;this.loginPassword="",this.loginNeedCaptcha=!0,this.loginCaptcha="",this.loggingIn=!1,this.$nextTick((function(){e.$refs["login-email-input"]&&e.$refs["login-email-input"].focus(),e.refreshCaptcha()}))}},{key:"refreshCaptcha",value:function(){this.loginCaptchaSrc="".concat(p["a"],"?t=").concat(Date.now()),this.loginCaptcha=""}},{key:"login",value:function(){var e=this;d["validate"](this.loginEmail)?0!==this.loginCaptcha.length?this.loginPassword.length<6||this.loginPassword.length>20?this.$Message.error(this.$t("account.message.invalidPassword")):(this.loggingIn=!0,Object(p["c"])(this.tempToken,this.loginEmail,this.loginPassword,this.loginCaptcha).then((function(t){return e.loggingIn=!1,window.sendIpcMessage(m["c"],t),!0})).catch((function(t){return e.loggingIn=!1,console.error("login failed"),console.error(t),e.refreshCaptcha(),t.code===h["g"]?e.$Message.error(e.$t("account.message.wrongEmailOrPwd")):t.code===h["a"]?e.$Message.error(e.$t("account.message.wrongCaptcha")):t.code===h["e"]||t.code===h["b"]?e.$Message.error(e.$t("account.message.invalidEmail")):e.$Message.error(e.$t("account.message.loginFail"))}))):this.$Message.error(this.$t("account.message.noCaptcha")):this.$Message.error(this.$t("account.message.invalidEmail"))}}]),t}(u["b"]);f=Object(g["a"])([Object(u["a"])({})],f);var w=f,C=w,k=(a("8342"),a("2877")),b=Object(k["a"])(C,i,n,!1,null,"b0d37640",null);t["default"]=b.exports},eecd:function(e,t,a){}}]);
//# sourceMappingURL=login.9da4156a.js.map