{"version":3,"sources":["webpack:///./src/views/Login.vue?a9b6","webpack:///./src/views/Login.vue?120c","webpack:///./src/views/Login.vue","webpack:///./src/views/Login.vue?5496","webpack:///./src/views/Login.vue?4027"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","on","login","directives","name","rawName","value","expression","ref","nativeOn","$event","type","indexOf","_k","keyCode","key","model","callback","$$v","loginEmail","loginPassword","resetpwd","loginCaptcha","loginCaptchaSrc","refreshCaptcha","_e","loggingIn","length","register","staticRenderFns","loginNeedCaptcha","modalTitle","tempToken","console","log","window","sendIpcMessage","addIpcListener","data","EventHub","$emit","plt","initPage","$router","push","$nextTick","$refs","focus","Date","now","$Message","error","$t","then","res","catch","err","code","component"],"mappings":"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","file":"js/login.9da4156a.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=b0d37640&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=b0d37640&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login-wrapper\"},[_c('Modal',{staticClass:\"login-alert-modal\",attrs:{\"width\":\"400\",\"footer-hide\":true}},[_c('div',{staticClass:\"modal-header\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"登录\")])]),_c('div',{staticClass:\"login-alert-msg\"},[_vm._v(\"\\n      登录后，临时账号的流量与积分将转移至邮箱账号，是否确认登录？\\n    \")]),_c('Button',{attrs:{\"size\":\"large\",\"type\":\"primary\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")])],1),_c('div',{staticClass:\"login-form\"},[_c('div',{staticClass:\"modal-header\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',{directives:[{name:\"t\",rawName:\"v-t\",value:(_vm.modalTitle),expression:\"modalTitle\"}]})]),_c('div',{staticClass:\"form-line\"},[_c('label',{directives:[{name:\"t\",rawName:\"v-t\",value:('account.ui.email'),expression:\"'account.ui.email'\"}],attrs:{\"for\":\"login-email\"}}),_c('Input',{ref:\"login-email-input\",staticClass:\"email-input\",attrs:{\"id\":\"login-email\",\"placeholder\":\"请输入邮箱\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.login($event)}},model:{value:(_vm.loginEmail),callback:function ($$v) {_vm.loginEmail=$$v},expression:\"loginEmail\"}})],1),_c('div',{staticClass:\"form-line\"},[_c('label',{directives:[{name:\"t\",rawName:\"v-t\",value:('account.ui.password'),expression:\"'account.ui.password'\"}],attrs:{\"for\":\"login-password\"}}),_c('Input',{staticClass:\"password-input\",attrs:{\"type\":\"password\",\"id\":\"login-password\",\"placeholder\":\"请输入密码\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.login($event)}},model:{value:(_vm.loginPassword),callback:function ($$v) {_vm.loginPassword=$$v},expression:\"loginPassword\"}}),_c('p',{staticClass:\"forget-pwd-hint\"},[_c('span',{staticClass:\"account-jump-btn reset-pwd-btn\",on:{\"click\":_vm.resetpwd}},[_vm._v(\"\\n          忘记密码\\n        \")])])],1),(_vm.loginNeedCaptcha)?_c('div',{staticClass:\"form-line\"},[_c('label',{directives:[{name:\"t\",rawName:\"v-t\",value:('account.ui.captcha'),expression:\"'account.ui.captcha'\"}],attrs:{\"for\":\"login-captcha\"}}),_c('Input',{staticClass:\"login-input\",attrs:{\"id\":\"login-captcha\",\"placeholder\":\"请输入验证码\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.login($event)}},model:{value:(_vm.loginCaptcha),callback:function ($$v) {_vm.loginCaptcha=$$v},expression:\"loginCaptcha\"}}),_c('img',{staticClass:\"captcha-image login-captcha-image\",attrs:{\"src\":_vm.loginCaptchaSrc,\"alt\":\"\",\"title\":\"switch\"},on:{\"click\":_vm.refreshCaptcha}})],1):_vm._e(),_c('Button',{directives:[{name:\"t\",rawName:\"v-t\",value:('account.ui.login'),expression:\"'account.ui.login'\"}],staticClass:\"login-btn large\",attrs:{\"loading\":_vm.loggingIn,\"disabled\":_vm.loginEmail.length === 0 ||\n          _vm.loginPassword.length === 0 ||\n          _vm.loginCaptcha.length === 0,\"type\":\"primary\",\"size\":\"large\"},on:{\"click\":_vm.login}}),_c('p',{staticClass:\"footer\"},[_vm._v(\"\\n      没有账号？\\n      \"),_c('span',{staticClass:\"account-jump-btn reg-btn\",on:{\"click\":_vm.register}},[_vm._v(\"注册\")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator'\nimport * as EmailValidator from 'email-validator'\n\nimport { captchaUrl, LoginResponse, login } from '@/services/server'\nimport * as ERR_CODES from '@/constants/errCodes'\nimport * as ZHUGE_EVENTS from '@/constants/zhugeIOEvents'\nimport { LOGIN_INIT, LOGIN_SUCCESS, TEMP_TOKEN, USER_DATA } from '@/constants/accountMsg'\nimport EventHub from './EventHub'\n\n@Component({})\nexport default class Login extends Vue {\n  loginEmail: string = ''\n  loginPassword: string = ''\n  loginNeedCaptcha: boolean = true\n  loginCaptchaSrc: string = ''\n  loginCaptcha: string = ''\n  loggingIn: boolean = false\n  modalTitle: string = 'account.ui.login'\n  tempToken: string = ''\n\n  mounted() {\n    console.log('login mounted')\n    // EventHub.$on('loginInit', () => {\n    //   this.initPage()\n    // })\n    window.sendIpcMessage(LOGIN_INIT)\n    this.refreshCaptcha()\n    window.addIpcListener(USER_DATA, (data: any) => {\n      EventHub.$emit('plt', data.plt)\n      this.tempToken = data.tempToken\n    })\n    this.initPage()\n  }\n  register() {\n    this.$router.push('/register')\n  }\n  created() {}\n  resetpwd() {\n    this.$router.push('/resetpwd')\n  }\n  initPage() {\n    this.loginPassword = ''\n    this.loginNeedCaptcha = true\n    this.loginCaptcha = ''\n    this.loggingIn = false\n    this.$nextTick(() => {\n      // must in $nextTick\n      if (this.$refs['login-email-input']) {\n        // @ts-ignore\n        this.$refs['login-email-input'].focus()\n      }\n      this.refreshCaptcha()\n    })\n  }\n\n  refreshCaptcha() {\n    this.loginCaptchaSrc = `${captchaUrl}?t=${Date.now()}`\n    this.loginCaptcha = ''\n  }\n\n  login() {\n    if (!EmailValidator.validate(this.loginEmail)) {\n      this.$Message.error(this.$t('account.message.invalidEmail'))\n      return\n    }\n    if (this.loginCaptcha.length === 0) {\n      this.$Message.error(this.$t('account.message.noCaptcha'))\n      return\n    }\n    if (this.loginPassword.length < 6 || this.loginPassword.length > 20) {\n      this.$Message.error(this.$t('account.message.invalidPassword'))\n      return\n    }\n    this.loggingIn = true\n    login(this.tempToken, this.loginEmail, this.loginPassword, this.loginCaptcha)\n      .then((res: LoginResponse) => {\n        this.loggingIn = false\n        window.sendIpcMessage(LOGIN_SUCCESS, res)\n        return true\n      })\n      .catch((err: any) => {\n        this.loggingIn = false\n        console.error('login failed')\n        console.error(err)\n        this.refreshCaptcha()\n        if (err.code === ERR_CODES.SERVER_EMAIL_OR_PASSWORD_ERROR) {\n          return this.$Message.error(this.$t('account.message.wrongEmailOrPwd'))\n        }\n        if (err.code === ERR_CODES.SERVER_CAPTCHA_ERROR) {\n          return this.$Message.error(this.$t('account.message.wrongCaptcha'))\n        }\n        if (\n          err.code === ERR_CODES.SERVER_EMAIL_FORMAT_ERROR ||\n          err.code === ERR_CODES.SERVER_EMAIL_ADDRESS_NONE\n        ) {\n          return this.$Message.error(this.$t('account.message.invalidEmail'))\n        }\n        return this.$Message.error(this.$t('account.message.loginFail'))\n      })\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=b0d37640&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=ts&\"\nexport * from \"./Login.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=b0d37640&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b0d37640\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}